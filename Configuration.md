# è§†è§‰é—®ç­”ç³»ç»Ÿé…ç½®è¯´æ˜

## ğŸ“‹ ç›®å½•

- [æ¦‚è¿°](#æ¦‚è¿°)
- [é…ç½®æ–¹å¼](#é…ç½®æ–¹å¼)
  - [1. é…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰](#1-é…ç½®æ–‡ä»¶æ–¹å¼æ¨è)
  - [2. å‘½ä»¤è¡Œå‚æ•°æ–¹å¼ï¼ˆä¾‹å­ï¼‰](#2-å‘½ä»¤è¡Œå‚æ•°æ–¹å¼ä¾‹å­)
- [é…ç½®æ–‡ä»¶æ ¼å¼](#é…ç½®æ–‡ä»¶æ ¼å¼)
- [å‘½ä»¤è¡Œå‚æ•°æ ¼å¼](#å‘½ä»¤è¡Œå‚æ•°æ ¼å¼)
  - [APIé…ç½®å‚æ•°](#apié…ç½®å‚æ•°)
  - [è·¯å¾„é…ç½®å‚æ•°](#è·¯å¾„é…ç½®å‚æ•°)
  - [ç³»ç»Ÿé…ç½®å‚æ•°](#ç³»ç»Ÿé…ç½®å‚æ•°)
  - [æ—¥å¿—çº§åˆ«è¯¦ç»†è¯´æ˜](#æ—¥å¿—çº§åˆ«è¯¦ç»†è¯´æ˜)
  - [å…¶ä»–å‚æ•°](#å…¶ä»–å‚æ•°)
- [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)
  - [1. åŸºæœ¬ä½¿ç”¨ï¼ˆä½¿ç”¨é»˜è®¤é…ç½®ï¼‰](#1-åŸºæœ¬ä½¿ç”¨ä½¿ç”¨é»˜è®¤é…ç½®)
  - [2. ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶](#2-ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶)
  - [3. ä»…è¦†ç›–APIé…ç½®](#3-ä»…è¦†ç›–apié…ç½®)
  - [4. ä»…è¦†ç›–è·¯å¾„é…ç½®](#4-ä»…è¦†ç›–è·¯å¾„é…ç½®)
  - [5. å®Œæ•´å‚æ•°ç¤ºä¾‹](#5-å®Œæ•´å‚æ•°ç¤ºä¾‹)
  - [6. ä¿®æ”¹APIè¶…æ—¶è®¾ç½®](#6-ä¿®æ”¹apiè¶…æ—¶è®¾ç½®)
  - [7. æŒ‡å®šç»­è·‘æ–‡ä»¶](#7-æŒ‡å®šç»­è·‘æ–‡ä»¶)
  - [8. ä»…ä½¿ç”¨é»˜è®¤è¾“å‡ºç›®å½•](#8-ä»…ä½¿ç”¨é»˜è®¤è¾“å‡ºç›®å½•)
  - [9. è¾“å‡ºç³»ç»Ÿè¯´æ˜](#9-è¾“å‡ºç³»ç»Ÿè¯´æ˜)
  - [10. ç»­è·‘ç³»ç»Ÿè¯´æ˜](#10-ç»­è·‘ç³»ç»Ÿè¯´æ˜)
- [é…ç½®å‚æ•°æ€»ç»“](#é…ç½®å‚æ•°æ€»ç»“)
  - [é…ç½®æ–‡ä»¶ä¸­å¯è®¾ç½®çš„å‚æ•°ï¼ˆå…±13ä¸ªï¼‰](#é…ç½®æ–‡ä»¶ä¸­å¯è®¾ç½®çš„å‚æ•°å…±13ä¸ª)
  - [è°ƒè¯•å»ºè®®](#è°ƒè¯•å»ºè®®)

## æ¦‚è¿°

HM3Dè§†è§‰é—®ç­”ç³»ç»Ÿæ”¯æŒé€šè¿‡é…ç½®æ–‡ä»¶å’Œå‘½ä»¤è¡Œå‚æ•°è¿›è¡Œçµæ´»é…ç½®ã€‚ç³»ç»Ÿé‡‡ç”¨é…ç½®ä¼˜å…ˆçº§ï¼š**å‘½ä»¤è¡Œå‚æ•° > é…ç½®æ–‡ä»¶ > é»˜è®¤å€¼**ã€‚

## é…ç½®æ–¹å¼

### 1. é…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰

åˆ›å»ºYAMLæ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ `--config` å‚æ•°æŒ‡å®šï¼š

```bash
python qwen-72b-hm3d-test.py --config config.yaml
```

### 2. å‘½ä»¤è¡Œå‚æ•°æ–¹å¼ï¼ˆä¾‹å­ï¼‰

ç›´æ¥é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šé…ç½®ï¼š

```bash
python qwen-72b-hm3d-test.py --api-key "your-key" --QA-dataset-file "/path/to/dataset"
```


## é…ç½®æ–‡ä»¶æ ¼å¼

é…ç½®æ–‡ä»¶é‡‡ç”¨YAMLæ ¼å¼ï¼ŒåŒ…å«ä¸‰ä¸ªä¸»è¦éƒ¨åˆ†ï¼š`system`ï¼ˆç³»ç»Ÿé…ç½®ï¼‰ã€`api`ï¼ˆAPIé…ç½®ï¼‰å’Œ `paths`ï¼ˆè·¯å¾„é…ç½®ï¼‰ã€‚

```yaml
# ç³»ç»Ÿé…ç½®
system:
  log_level: "DEBUG"  # æ—¥å¿—çº§åˆ«ï¼šDEBUG/INFO/WARNING/ERROR

# APIé…ç½®
api:
  api_key: "your-api-key"
  base_url: "http://your-api-server/v1"
  model_name: "your-model-name"
  timeout: 60.0
  conceptnet_url: "http://conceptnet-server:port/query"
  conceptnet_timeout: 10

# è·¯å¾„é…ç½®
paths:
  QA_dataset_file: "/path/to/dataset.json"
  scene_frames_directory: "/path/to/frames"
  object_frames: "/path/to/hm3d/objects"
  output_directory: "."  # è¾“å‡ºç›®å½•ï¼ŒJSONå’ŒLOGæ–‡ä»¶éƒ½åœ¨æ­¤ç›®å½•ä¸‹ï¼Œé»˜è®¤ä¸ºå½“å‰è¿è¡Œè·¯å¾„
  resume_file: ""  # ç»­è·‘æ–‡ä»¶è·¯å¾„ï¼Œç©ºå­—ç¬¦ä¸²è¡¨ç¤ºä½¿ç”¨è¾“å‡ºç›®å½•ä¸‹çš„JSONæ–‡ä»¶
```

## å‘½ä»¤è¡Œå‚æ•°æ ¼å¼

### APIé…ç½®å‚æ•°

| å‚æ•° | å‘½ä»¤è¡Œå½¢å¼ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------------|--------|------|
| APIå¯†é’¥ | `--api-key` | `sk-AmsPKZtzRvfao8UY64899d50708b42E6B997999d91B4Ce53` | OpenAI APIå¯†é’¥ |
| APIæœåŠ¡åœ°å€ | `--base-url` | `http://llm.bnuzh.edu.cn:9080/v1` | APIæœåŠ¡åœ°å€ |
| æ¨¡å‹åç§° | `--model-name` | `qwen25-vl` | ä½¿ç”¨çš„æ¨¡å‹åç§° |
| APIè¶…æ—¶æ—¶é—´ | `--api-timeout` | `60.0` | APIè¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |
| ConceptNetåœ°å€ | `--conceptnet-url` | `http://10.20.1.2:8084/query` | ConceptNet APIåœ°å€ |
| ConceptNetè¶…æ—¶ | `--conceptnet-timeout` | `10` | ConceptNet APIè¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |

### è·¯å¾„é…ç½®å‚æ•°

| å‚æ•°  | å‘½ä»¤è¡Œå½¢å¼   | é»˜è®¤å€¼  | è¯´æ˜ |
|------|------------|--------|------|
| æ•°æ®é›†æ–‡ä»¶ | `--QA-dataset-file` | `/home/eg4/pwttt/data/openeqa/open-eqa-v0.json` | EQAé—®ç­”æ•°æ®é›†JSONæ–‡ä»¶è·¯å¾„ |
| å¸§å›¾ç‰‡ç›®å½• | `--scene-frames-directory` | `/mnt/my_hub2/dataset/openeqa/hm3d-v0` | åœºæ™¯å¸§å›¾ç‰‡æ ¹ç›®å½• |
| ç‰©ä½“å›¾ç‰‡ç›®å½• | `--object-frames` | `/mnt/my_hub2/å¤„ç†çš„æ•°æ®/hm3d` | ç‰©ä½“å›¾ç‰‡æ ¹ç›®å½• |
| è¾“å‡ºç›®å½• | `--output-dir` | `.` | è¾“å‡ºç›®å½•ï¼ˆJSONå’ŒLOGæ–‡ä»¶éƒ½åœ¨æ­¤ç›®å½•ä¸‹ï¼‰ï¼Œé»˜è®¤ä¸ºå½“å‰è¿è¡Œè·¯å¾„ |
| ç»­è·‘æ–‡ä»¶ | `--resume-file` | ç©ºï¼ˆä½¿ç”¨é»˜è®¤ï¼‰ | ç»­è·‘æ–‡ä»¶è·¯å¾„ï¼Œæœªè®¾ç½®æ—¶ä½¿ç”¨è¾“å‡ºç›®å½•ä¸‹çš„JSONæ–‡ä»¶ |

### ç³»ç»Ÿé…ç½®å‚æ•°

| å‚æ•° | å‘½ä»¤è¡Œå½¢å¼ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------------|--------|------|
| æ—¥å¿—çº§åˆ« | `--log-level` | `INFO`ï¼ˆä»…å½“æœªæŒ‡å®šå‘½ä»¤è¡Œå‚æ•°æ—¶ä½¿ç”¨ï¼‰ | æ—¥å¿—çº§åˆ«ï¼šDEBUG/INFO/WARNING/ERRORï¼Œ**å‘½ä»¤è¡Œå‚æ•°ä¼˜å…ˆäºconfig.yamlä¸­çš„è®¾ç½®** |

#### æ—¥å¿—çº§åˆ«è¯¦ç»†è¯´æ˜ï¼š

**DEBUG** - è°ƒè¯•æ¨¡å¼
- æ˜¾ç¤ºæ‰€æœ‰æ—¥å¿—ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯
- åŒ…å«ConceptNetæŸ¥è¯¢URLã€åŸå§‹å“åº”ã€å›¾ç‰‡å¤„ç†è¿‡ç¨‹ç­‰è¯¦ç»†ä¿¡æ¯
- é€‚ç”¨äºå¼€å‘è°ƒè¯•å’Œé—®é¢˜æ’æŸ¥

**INFO** - ä¿¡æ¯æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
- æ˜¾ç¤ºé‡è¦çš„ç¨‹åºè¿è¡Œä¿¡æ¯
- åŒ…å«å¤„ç†è¿›åº¦ã€é…ç½®åŠ è½½ã€æ–‡ä»¶ç”Ÿæˆç­‰å…³é”®ä¿¡æ¯
- é€‚ç”¨äºæ­£å¸¸è¿è¡Œç›‘æ§

**WARNING** - è­¦å‘Šæ¨¡å¼
- ä»…æ˜¾ç¤ºè­¦å‘Šå’Œé”™è¯¯ä¿¡æ¯
- å¿½ç•¥æ­£å¸¸çš„ç¨‹åºè¿è¡Œä¿¡æ¯
- é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒç›‘æ§

**ERROR** - é”™è¯¯æ¨¡å¼
- ä»…æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
- æœ€ç®€æ´çš„æ—¥å¿—è¾“å‡ºï¼Œä»…å…³æ³¨ä¸¥é‡é—®é¢˜
- é€‚ç”¨äºè‡ªåŠ¨åŒ–è„šæœ¬å’Œé™é»˜è¿è¡Œ

### å…¶ä»–å‚æ•°

| å‚æ•° | å‘½ä»¤è¡Œå½¢å¼ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------------|--------|------|
| é…ç½®æ–‡ä»¶ | `--config` | æ—  | YAMLé…ç½®æ–‡ä»¶è·¯å¾„ |

## ä½¿ç”¨ç¤ºä¾‹

### 1. åŸºæœ¬ä½¿ç”¨ï¼ˆä½¿ç”¨é»˜è®¤é…ç½®ï¼‰

```bash
python qwen-72b-hm3d-test.py
```

### 2. ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶

```bash
# åˆ›å»ºé…ç½®æ–‡ä»¶ my_config.yaml
python qwen-72b-hm3d-test.py --config my_config.yaml
```

### 3. ä»…è¦†ç›–APIé…ç½®

```bash
python qwen-72b-hm3d-test.py \
  --api-key "your-new-api-key" \
  --base-url "http://your-server:8080/v1" \
  --model-name "your-model"
```

### 4. ä»…è¦†ç›–è·¯å¾„é…ç½®

```bash
python qwen-72b-hm3d-test.py \
  --QA-dataset-file "/data/my_dataset.json" \
  --scene-frames-directory "/data/frames" \
  --output-dir "/results/output"
```

### 5. å®Œæ•´å‚æ•°ç¤ºä¾‹

```bash
python qwen-72b-hm3d-test.py \
  --config config.yaml \
  --api-key "sk-your-key" \
  --base-url "http://localhost:8000/v1" \
  --model-name "custom-model" \
  --QA-dataset-file "/path/to/custom_dataset.json" \
  --scene-frames-directory "/path/to/custom_frames" \
  --output-dir "/path/to/custom_output" \
  --log-level "DEBUG"
```

### 6. è¾“å‡ºç³»ç»Ÿè¯´æ˜

**è¾“å‡ºæ–‡ä»¶è¡Œä¸ºï¼š**
- **ç»Ÿä¸€è¾“å‡ºç›®å½•**ï¼šJSONå’ŒLOGæ–‡ä»¶æ€»æ˜¯åœ¨åŒä¸€ç›®å½•ä¸‹ç”Ÿæˆ
- **æ™ºèƒ½é»˜è®¤è·¯å¾„**ï¼šæœªæŒ‡å®šæ—¶ï¼Œä½¿ç”¨å½“å‰è¿è¡Œè·¯å¾„ï¼ˆ`.`ï¼‰
- **è‡ªåŠ¨å‘½å**ï¼š
  - JSONæ–‡ä»¶ï¼š`openeqa-{MODEL_NAME}.json`
  - LOGæ–‡ä»¶ï¼š`openeqa-{MODEL_NAME}.log`
- **è¿½åŠ æ¨¡å¼**ï¼šæ—¥å¿—ä»¥è¿½åŠ æ¨¡å¼å†™å…¥ï¼Œä¿ç•™å†å²è¿è¡Œè®°å½•
- **è‡ªåŠ¨ç›®å½•åˆ›å»º**ï¼šå¦‚æœè¾“å‡ºç›®å½•ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»º

**æ–‡ä»¶å‘½åç¤ºä¾‹ï¼š**
- æ¨¡å‹åä¸º`qwen25-vl`æ—¶ï¼š
  - JSONï¼š`openeqa-qwen25-vl.json`
  - LOGï¼š`openeqa-qwen25-vl.log`

**è¾“å‡ºé…ç½®ç¤ºä¾‹ï¼š**
```yaml
# ä½¿ç”¨é»˜è®¤è·¯å¾„ï¼ˆå½“å‰è¿è¡Œç›®å½•ï¼‰
paths:
  output_directory: "."

# æŒ‡å®šè‡ªå®šä¹‰è·¯å¾„
paths:
  output_directory: "/home/eg4/experiments"

# ä½¿ç”¨ç›¸å¯¹è·¯å¾„
paths:
  output_directory: "./results"
```

**å‘½ä»¤è¡ŒæŒ‡å®šè¾“å‡ºç›®å½•ï¼š**
```bash
# ä½¿ç”¨é»˜è®¤è¾“å‡ºç›®å½•
python qwen-72b-hm3d-test.py

# æŒ‡å®šå®Œæ•´è·¯å¾„
python qwen-72b-hm3d-test.py --output-dir "/path/to/results"

# æŒ‡å®šç›¸å¯¹è·¯å¾„
python qwen-72b-hm3d-test.py --output-dir "./my_experiment"
```

### 7. ç»­è·‘ç³»ç»Ÿè¯´æ˜

**ç»­è·‘æ–‡ä»¶è¡Œä¸ºï¼š**
- **ç²¾ç¡®è·¯å¾„æ§åˆ¶**ï¼šç»­è·‘æ–‡ä»¶éœ€è¦æŒ‡å®šå®Œæ•´çš„è·¯å¾„å’Œæ–‡ä»¶åç§°
- **æ™ºèƒ½é»˜è®¤è¡Œä¸º**ï¼šæœªæŒ‡å®šæ—¶ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œè‡ªåŠ¨ä½¿ç”¨è¾“å‡ºè·¯å¾„ä¸‹çš„è¾“å‡ºJSONæ–‡ä»¶
  - ä¾‹å¦‚ï¼šè¾“å‡ºæ–‡ä»¶ä¸º`/results/openeqa-qwen25-vl.json`ï¼Œç»­è·‘æ–‡ä»¶ä¹Ÿä¸ºåŒä¸€æ–‡ä»¶
- **ç”¨æˆ·è‡ªå®šä¹‰**ï¼šå¯æŒ‡å®šä»»æ„ç»­è·‘æ–‡ä»¶çš„å®Œæ•´è·¯å¾„
- **æ–­ç‚¹ç»­è·‘**ï¼šè‡ªåŠ¨è·³è¿‡å·²å®Œæˆçš„é—®é¢˜ï¼Œä»æ–­ç‚¹ç»§ç»­å¤„ç†

**ç»­è·‘é…ç½®ç¤ºä¾‹ï¼š**
```yaml
# ä½¿ç”¨è¾“å‡ºæ–‡ä»¶ä½œä¸ºç»­è·‘æ–‡ä»¶ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰
paths:
  resume_file: ""

# æŒ‡å®šè‡ªå®šä¹‰ç»­è·‘æ–‡ä»¶ï¼ˆå®Œæ•´è·¯å¾„ï¼‰
paths:
  resume_file: "/home/eg4/results/backup_resume.json"

# ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆç›¸å¯¹äºå½“å‰è¿è¡Œç›®å½•ï¼‰
paths:
  resume_file: "./resume/custom.json"

# è·¨ç›®å½•ç»­è·‘ï¼ˆä»å…¶ä»–å®éªŒçš„ç»“æœç»§ç»­ï¼‰
paths:
  resume_file: "/home/eg4/experiments/branch1/openeqa-qwen25-vl.json"
```

**å‘½ä»¤è¡ŒæŒ‡å®šç»­è·‘æ–‡ä»¶ï¼š**
```bash
# ä½¿ç”¨é»˜è®¤ç»­è·‘ï¼ˆä¸è¾“å‡ºæ–‡ä»¶ç›¸åŒï¼‰
python qwen-72b-hm3d-test.py

# æŒ‡å®šè‡ªå®šä¹‰ç»­è·‘æ–‡ä»¶ï¼ˆå®Œæ•´è·¯å¾„ï¼‰
python qwen-72b-hm3d-test.py --resume-file "/path/to/resume.json"
```

### è°ƒè¯•å»ºè®®

1. ä½¿ç”¨ `--log-level DEBUG` è·å–è¯¦ç»†æ—¥å¿—
2. å…ˆç”¨å°æ•°æ®é›†æµ‹è¯•é…ç½®
3. é€ä¸ªéªŒè¯å„æœåŠ¡è¿æ¥çŠ¶æ€
4. æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•æ­£ç¡®æ€§
